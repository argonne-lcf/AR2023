<!DOCTYPE html>
<html lang="en"><head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1"><!-- Begin Jekyll SEO tag v2.8.0 -->
<title>BraggNN: Fast X-ray Bragg Peak Analysis Using Deep Learning | 2023 ALCF Annual Report</title>
<meta name="generator" content="Jekyll v3.9.3" />
<meta property="og:title" content="BraggNN: Fast X-ray Bragg Peak Analysis Using Deep Learning" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="A group of researchers from Argonne National Laboratory is harnessing AI to perform the challenging task of analyzing data from high-energy x-ray diffraction experiments. With a new neural network-based method called BraggNN, the Argonne team can more rapidly and precisely identify Bragg peaks—data points that indicate positions and orientations of tiny individual crystals—in a fraction of the time they used to." />
<meta property="og:description" content="A group of researchers from Argonne National Laboratory is harnessing AI to perform the challenging task of analyzing data from high-energy x-ray diffraction experiments. With a new neural network-based method called BraggNN, the Argonne team can more rapidly and precisely identify Bragg peaks—data points that indicate positions and orientations of tiny individual crystals—in a fraction of the time they used to." />
<link rel="canonical" href="http://localhost:4000/science/highlights/liu" />
<meta property="og:url" content="http://localhost:4000/science/highlights/liu" />
<meta property="og:site_name" content="2023 ALCF Annual Report" />
<meta property="og:image" content="http://localhost:4000/liu.png" />
<meta property="og:type" content="article" />
<meta property="article:published_time" content="2024-01-29T14:21:20-06:00" />
<meta name="twitter:card" content="summary_large_image" />
<meta property="twitter:image" content="http://localhost:4000/liu.png" />
<meta property="twitter:title" content="BraggNN: Fast X-ray Bragg Peak Analysis Using Deep Learning" />
<script type="application/ld+json">
{"@context":"https://schema.org","@type":"BlogPosting","dateModified":"2024-01-29T14:21:20-06:00","datePublished":"2024-01-29T14:21:20-06:00","description":"A group of researchers from Argonne National Laboratory is harnessing AI to perform the challenging task of analyzing data from high-energy x-ray diffraction experiments. With a new neural network-based method called BraggNN, the Argonne team can more rapidly and precisely identify Bragg peaks—data points that indicate positions and orientations of tiny individual crystals—in a fraction of the time they used to.","headline":"BraggNN: Fast X-ray Bragg Peak Analysis Using Deep Learning","image":"http://localhost:4000/liu.png","mainEntityOfPage":{"@type":"WebPage","@id":"http://localhost:4000/science/highlights/liu"},"url":"http://localhost:4000/science/highlights/liu"}</script>
<!-- End Jekyll SEO tag -->
<link rel="stylesheet" href="https://use.typekit.net/vpa7ous.css">
  <link rel="stylesheet" href="/assets/css/main.css">
  <link rel="shortcut icon" href="http://localhost:4000/favicon.ico"><link type="application/atom+xml" rel="alternate" href="http://localhost:4000/feed.xml" title="2023 ALCF Annual Report" /></head>

<!-- Google tag (gtag.js) -->
<script async src="https://www.googletagmanager.com/gtag/js?id=G-V7JP2R5JPH"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-V7JP2R5JPH');
</script><body><header class="header" role="banner">

  <div class="nav-wrapper">
    <div class="nav-desktop">

      <div class="masthead">
        <h1><a href="http://localhost:4000/index.html">ALCF Annual Report</a></h1>
      </div>


      <div class="nav">
        
          <h2>
            
              <a href="http://localhost:4000/year-in-review/directors-letter">Year in Review</a>
            
            <!-- <a href="http://localhost:4000/year-in-review/directors-letter">Year in Review</a> -->
          </h2>
        
          <h2>
            
              <a href="http://localhost:4000/features">Features</a>
            
            <!-- <a href="http://localhost:4000/features">Features</a> -->
          </h2>
        
          <h2>
            
              <a href="http://localhost:4000/community-and-outreach">Growing the HPC Community</a>
            
            <!-- <a href="http://localhost:4000/community-and-outreach">Growing the HPC Community</a> -->
          </h2>
        
          <h2>
            
              <a href="http://localhost:4000/expertise-and-resources">Expertise and Resources</a>
            
            <!-- <a href="http://localhost:4000/expertise-and-resources">Expertise and Resources</a> -->
          </h2>
        
          <h2>
            
              <a class="current" href="http://localhost:4000/science">Science</a>
            
            <!-- <a href="http://localhost:4000/science">Science</a> -->
          </h2>
        
      </div>

    </div>
  </div>


  <div class="nav-wrapper">
    <div class="nav-mobile">

      <div class="masthead">
        <h1><a href="http://localhost:4000/index.html">ALCF Annual Report</a></h1>
      </div>


      <div class="nav">
        <div class="js-drop menuitem-wrapper" id="toggle-menu" data-menu="menu">
          <h1>Menu &blacktriangledown;</h1>
          <div id="menu" class="dropdown js-dropdown-hidden">

            <div class="nav-wrapper">
               

                <div class="chunk">
                  <h2>
                    <a href="/year-in-review/directors-letter" class="menuitem">
                      Year in Review
                    </a>
                  </h2>

                  
                    <ul>
                      
                        <li>
                          <a href="/year-in-review/directors-letter">
                            Director&rsquo;s Letter
                          </a>
                        </li>
                      
                        <li>
                          <a href="/year-in-review/year-in-review">
                            ALCF Leadership
                          </a>
                        </li>
                      
                        <li>
                          <a href="/year-in-review/about-alcf">
                            About ALCF
                          </a>
                        </li>
                      
                    </ul>
                   
                </div>
               

                <div class="chunk">
                  <h2>
                    <a href="/features" class="menuitem">
                      Features
                    </a>
                  </h2>

                  
                    <ul>
                      
                        <li>
                          <a href="/features/polaris">
                            Polaris Enters Production Mode
                          </a>
                        </li>
                      
                        <li>
                          <a href="/features/alcf-ai-testbed">
                            ALCF AI Testbed Systems Deployed for Open Science
                          </a>
                        </li>
                      
                        <li>
                          <a href="/features/aurora">
                            Aurora Takes Shape in the ALCF Data Center
                          </a>
                        </li>
                      
                        <li>
                          <a href="/features/sunspot">
                            Sunspot Testbed Provides On-Ramp for Aurora
                          </a>
                        </li>
                      
                        <li>
                          <a href="/features/aurora-and-aps">
                            Transforming Science with Aurora and the Upgraded APS
                          </a>
                        </li>
                      
                        <li>
                          <a href="/features/gordon-bell-prize">
                            Argonne-Led Team Wins Gordon Bell Special Prize for COVID-19 Research
                          </a>
                        </li>
                      
                    </ul>
                   
                </div>
               

                <div class="chunk">
                  <h2>
                    <a href="/community-and-outreach" class="menuitem">
                      Growing the HPC Community
                    </a>
                  </h2>

                  
                    <ul>
                      
                        <li>
                          <a href="/community-and-outreach/industry">
                            Partnering with Industry
                          </a>
                        </li>
                      
                        <li>
                          <a href="/community-and-outreach/dei">
                            Building a Diverse HPC Workforce
                          </a>
                        </li>
                      
                        <li>
                          <a href="/community-and-outreach/hpc-community-activities">
                            Shaping the Future of Supercomputing
                          </a>
                        </li>
                      
                        <li>
                          <a href="/community-and-outreach/user-training-activities">
                            Training ALCF Users
                          </a>
                        </li>
                      
                        <li>
                          <a href="/community-and-outreach/educational-outreach-activities">
                            Inspiring Students
                          </a>
                        </li>
                      
                    </ul>
                   
                </div>
               

                <div class="chunk">
                  <h2>
                    <a href="/expertise-and-resources" class="menuitem">
                      Expertise and Resources
                    </a>
                  </h2>

                  
                    <ul>
                      
                        <li>
                          <a href="/expertise-and-resources/systems">
                            ALCF Systems
                          </a>
                        </li>
                      
                        <li>
                          <a href="/expertise-and-resources/team">
                            ALCF Team
                          </a>
                        </li>
                      
                        <li>
                          <a href="/expertise-and-resources/staff-spotlights">
                            Staff Spotlights
                          </a>
                        </li>
                      
                        <li>
                          <a href="/expertise-and-resources/staff-news">
                            Staff News
                          </a>
                        </li>
                      
                    </ul>
                   
                </div>
               

                <div class="chunk">
                  <h2>
                    <a href="/science" class="menuitem">
                      Science
                    </a>
                  </h2>

                  
                    <ul>
                      
                        <li>
                          <a href="/science/allocation-programs">
                            Allocation Programs
                          </a>
                        </li>
                      
                        <li>
                          <a href="/science/highlights">
                            2022 Science Highlights
                          </a>
                        </li>
                      
                        <li>
                          <a href="/science/projects">
                            Projects
                          </a>
                        </li>
                      
                        <li>
                          <a href="/science/publications">
                            Publications
                          </a>
                        </li>
                      
                    </ul>
                   
                </div>
                
            </div>
            
          </div>
        </div>
      </div>

    </div>
  </div>

</header>




<nav class="sidenav">

  

    
    
    
    
  

    
    
    
    
  

    
    
    
    
  

    
    
    
    
  

    
      <h2>
        <a href="http://localhost:4000/science" class="menuitem">
          Science
        </a>
      </h2>

      
        <ul>
          
            <li>
              <!-- science/allocation-programs AND science/highlights/liu -->
              
                <a href="http://localhost:4000/science/allocation-programs">Allocation Programs</a>
              
            </li>
          
            <li>
              <!-- science/highlights AND science/highlights/liu -->
              
                <a class="current" href="http://localhost:4000/science/highlights">2022 Science Highlights</a>
              
            </li>
          
            <li>
              <!-- science/projects AND science/highlights/liu -->
              
                <a href="http://localhost:4000/science/projects">Projects</a>
              
            </li>
          
            <li>
              <!-- science/publications AND science/highlights/liu -->
              
                <a href="http://localhost:4000/science/publications">Publications</a>
              
            </li>
          
        </ul>
      
    
    
    
    
  


</nav>

<main class="page-content layout-wrapper sci-highlight" aria-label="Content">

	<!-- 

TEXT, BREADCRUMBS

-------------------------------------------------------------------------------

available parameters:

* required

-------------------------------------------------------------------------------

-->

<div id="breadcrumbs">
 
<a href="http://localhost:4000/index">Home</a>

  
    / <a href="http://localhost:4000/science">Science</a>
  

  
    / <a href="http://localhost:4000/science/highlights">Highlights</a>
  

  
    / BraggNN: Fast X-ray Bragg Peak Analysis Using Deep Learning
  

</div>
	
	<!-- 

TEXT, CATEGORIZATION

-------------------------------------------------------------------------------

available parameters:
* field
* sdl

* required

-------------------------------------------------------------------------------

-->





<div class="cat">

	<p>
		<span class="cat--field">Materials Science</span> | 

		
			<span class="cat--sdl"><span class="inactive">&#xe905;</span>&#xe903;&#xe904;</span> Data, Learning
		
	</p>

</div>

	<h1 class="page-title">BraggNN: Fast X-ray Bragg Peak Analysis Using Deep Learning</h1>

	<!-- 

TEXT, META

-------------------------------------------------------------------------------

available parameters:
* name-1
* value-1
- name-2
- value-2
- name-3
- value-3
- name-4
- value-4
- name-5
- value-5
- name-6
- value-6

* required

-------------------------------------------------------------------------------

-->

<div class="meta">

	<p class="meta--pair">
		<span class="meta--name">PI</span>: 
		<span class="meta--val">Zhengchun Liu, Argonne National Laboratory</span>
	</p>
	
	
		<p class="meta--pair">
			<span class="meta--name">AWARD</span>: 
			<span class="meta--val">Director's Discretionary</span>
		</p>
	

	

	

	

	

</div>



	<!-- 

MEDIA, IMAGE
please use hero-page include for hero images

-------------------------------------------------------------------------------

available parameters:
* source
- caption
- credit

* required

-------------------------------------------------------------------------------

-->


<div class="media-img">
	<div class="img-wrapper">
		<div><img src="http://localhost:4000/assets/images/liu.png"></div>
	</div>

	
		<small class="caption">
			Comparison of BraggNN, pseudo-Voigt FF-HEDM, and NF-HEDM. Grain positions from NF-HEDM (black squares), pseudo-Voigt FF-HEDM (red circles) and BraggNN FF-HEDM (blue triangles) overlaid on the NF-HEDM confidence map.
			
				<span class="credit">Image: Antonino Miceli, Argonne National Laboratory</span>
			
		</small>
	
</div>


	<div class="primary-txt">
		<!-- 

TEXT, INTRO

-------------------------------------------------------------------------------

available parameters:
* blurb

* required

-------------------------------------------------------------------------------

-->

<p class="intro">A group of researchers from Argonne National Laboratory is harnessing AI to perform the challenging task of analyzing data from high-energy x-ray diffraction experiments. With a new neural network-based method called BraggNN, the Argonne team can more rapidly and precisely identify Bragg peaks—data points that indicate positions and orientations of tiny individual crystals—in a fraction of the time they used to.</p>

<h1 id="challenge">Challenge</h1>

<p>In recent years, a technique called high-energy diffraction microscopy (HEDM) has become an important tool for accurately characterizing complex materials with high resolution. Although HEDM has proven to be a great improvement over conventional techniques, it can also be expensive and time-consuming. It involves the collection of enormous datasets, analysis of millions of Bragg diffraction peaks and reconstruction of the sample using those peaks. The impending upgrade of Argonne’s Advanced Photon Source (APS) is expected to vastly improve the speed of HEDM data acquisition to a minute or less. But the computing time to complete analysis Bragg peaks can extend to hours or weeks, even with the largest supercomputers. Not only do such delays slow research, but they also prevent the use of HEDM information to steer experiments.</p>

<h1 id="approach">Approach</h1>

<p>To address these challenges, the Argonne team developed BraggNN, a novel deep learning-based method that can accurately characterize Bragg diffraction peaks in HEDM images much more rapidly than conventional methods. The BraggNN network architecture comprises a series of convolutional neural network layers acting as feature extractors, followed by a series of fully connected layers that generate a regression prediction. The team used the ALCF’s ThetaGPU system and Cerebras AI accelerator to train the BraggNN model with a collection of data containing diffraction peaks.</p>

<h1 id="results">Results</h1>

<p>To evaluate the performance of BraggNN, the researchers compared the results with the reconstructed position of grains in addition to diffraction peak positions. When applied to a real experimental dataset, they found the grain positions using BraggNN resulted in errors being 15 percent smaller than those calculated using convention pseudo-Voigt fitting. Recent advances in deep learning method implementations and special-purpose model inference accelerators allow BraggNN to deliver significant performance improvements relative to the traditional method, running, for example, more than 200 times faster on a consumer-class GPU card with out-of-the-box software.</p>

<h1 id="impact">Impact</h1>

<p>The team has developed the first machine learned-based method for precisely characterizing Bragg diffraction peaks in HEDM images. Capable of precisely identifying Bragg peaks more quickly than conventional methods, the BraggNN method also stands to benefit high-resolution, high-throughput, and latency-sensitive applications, including real-time analysis and experiment steering.</p>

	</div>



	

	<!-- 

TEXT, PUBLICATION LIST

-------------------------------------------------------------------------------

available parameters:
* pubs

* required

-------------------------------------------------------------------------------

-->

<div class="pubs">
	<h3>PUBLICATIONS</h3>

	<ul>

		
			<li>
				
					<a href="https://doi.org/10.1107/S2052252521011258">
						<span class="authors">Liu, Z., H. Sharma, J.-S. Park, P. Kenesei, A. Miceli, J. Almer, R. Kettimuthu, and I. Foster. </span>
						<span class="title">&ldquo;BraggNN: Fast X-ray Bragg Peak Analysis Using Deep Learning,&rdquo; </span>
						<span class="source"><i>IUCrJ</i> </span>
						<span class="date">(December 2021), </span>
						<span class="publisher">International Union of Crystallography.</span>
					</a>
				
			</li>
		

		

	</ul>

</div>


	

	<button class="to-top js-to-top">
		Back to Top &uarr;
	</button>

</main><footer>

	<div class="content-wrapper">


		<div class="alcf-logo">
			<img src="http://localhost:4000/assets/images/logo-h.png" />
		</div>

		<div class="alcf-info">
			<h2>CONTACT</h2>
			<p>
				<a href="mailto:media@alcf.anl.gov">media@alcf.anl.gov</a><br>
				<a href="https://alcf.anl.gov/">alcf.anl.gov</a>
			</p>
		</div>

		<div class="smallprint">
			<ul>
				<li><a href="http://localhost:4000/about">About</a></li>
				<li><a href="http://localhost:4000/disclaimer">Disclaimer</a></li>
				<li><a href="http://localhost:4000/credits">Credits</a></li>
			</ul>
		</div>




		<div class="bottom">
			<hr>

			<div class="doe-info">
				<img src="http://localhost:4000/assets/images/doe.png" />
				<p>Argonne National Laboratory is a U.S. Department of Energy laboratory<br>managed by UChicago Argonne, LLC.</p>
			</div>

		</div>
	
  </div>

  <script src="/assets/js/plugin--totop.js"></script>
  <script src="/assets/js/plugin--dropdown.js"></script>
  <script src="/assets/js/app.js"></script>

</footer>
</body>

</html>
